ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away from adult song") +
theme(plot.title = element_text(size = 9))
farther.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away from adult song") +
theme(plot.title = element_text(size = 9))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches closer to adult song") +
theme(plot.title = element_text(size = 10))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.1)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer to adult song") +
theme(plot.title = element_text(size = 8))
differences.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.05)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer to adult song") +
theme(plot.title = element_text(size = 8))
differences.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer to adult song") +
theme(plot.title = element_text(size = 8))
differences.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer to adult song") +
theme(plot.title = element_text(size = 8.5))
differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away from adult song") +
theme(plot.title = element_text(size = 9))
farther.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away from adult song") +
theme(plot.title = element_text(size = 9.5))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches closer to adult song") +
theme(plot.title = element_text(size = 10))
closer.plot
#Task 3: Summarize the data
library(patchwork)
farther.plot + closer.plot + differences.plot
farther.plot + closer.plot / differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away from adult song") +
theme(plot.title = element_text(size = 8))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches closer to adult song") +
theme(plot.title = element_text(size = 8))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer to adult song") +
theme(plot.title = element_text(size = 8))
differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away") +
theme(plot.title = element_text(size = 8))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches closer to adult song") +
theme(plot.title = element_text(size = 8))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 8))
differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches further away") +
theme(plot.title = element_text(size = 7))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels for young zebra finches closer to adult song") +
theme(plot.title = element_text(size = 7))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 10))
differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when singing further away") +
theme(plot.title = element_text(size = 7))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when closer to adult song") +
theme(plot.title = element_text(size = 7))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 9))
differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when singing further away") +
theme(plot.title = element_text(size = 8))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when closer") +
theme(plot.title = element_text(size = 8))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 9))
differences.plot
(farther.plot + closer.plot) / differences.plot
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when further away") +
theme(plot.title = element_text(size = 8))
farther.plot
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when closer") +
theme(plot.title = element_text(size = 8))
closer.plot
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 9))
differences.plot
(farther.plot + closer.plot) / differences.plot
summary = function(data) {
mean = mean(data)
min = min(data)
max = max(data)
sd = sd(data)
median = median(data)
return(c(min, max, median, mean, sd))
}
farther = summary(dopamine.data$`Farther_vals`)
closer = summary(dopamine.data$`Closer_vals`)
differences = summary(dopamine.data$difference)
table = data.frame()
table = rbind(farther,
closer,
differences) |> as.data.frame()
summary.table = table |>
rename(min = "V1",
max = "V2",
median = "V3",
mean = "V4",
sd = "V5")
view(summary.table)
?t.test
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = , conf.level = 0.95)
closer.t.test
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
closer.t.test
view(summary.table)
#part b
farther.t.test = t.test(x=dopamine.data$`Farther_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
farther.t.test
#part c
differences.t.test = t.test(x=dopamine.data$`difference`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
differences.t.test
hedges_g(x = dopamine.data$`Closer_vals`, mu = 0, alternative = "two.sided")
#part a
library(effectsize)
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
hedges_g(x = dopamine.data$`Closer_vals`, mu = 0, alternative = "two.sided")
#part a
install.packages("effectsize")
library(effectsize)
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
closer.t.test
hedges_g(x = dopamine.data$`Closer_vals`, mu = 0, alternative = "two.sided")
hedges_g(x = dopamine.data$`Farther_vals`, mu = 0, alternative = "two.sided")
#part c
differences.t.test = t.test(x=dopamine.data$`difference`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
differences.t.test
hedges_g(x = dopamine.data$`difference`, mu = 0, alternative = "two.sided")
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
closer.t.test
g = hedges_g(x = dopamine.data$`Closer_vals`, mu = 0, alternative = "two.sided")
#part b
farther.t.test = t.test(x=dopamine.data$`Farther_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
farther.t.test
g = hedges_g(x = dopamine.data$`Farther_vals`, mu = 0, alternative = "two.sided")
#part c
differences.t.test = t.test(x=dopamine.data$`difference`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
differences.t.test
g = hedges_g(x = dopamine.data$`difference`, mu = 0, alternative = "two.sided")
?dt
#Lab 11
install.packages("tidyverse")
library(tidyverse)
#Task 1: Power Analysis
install.packages("pwr")
library(pwr)
#n = 20.58039, so 21 observations required
power.analysis = pwr.t.test(d=0.65, sig.level = 0.05, power = 0.80, type = "one.sample", alternative = "two.sided")
#Task 2: Collect data
dopamine.data = read_csv("DopamineData.csv")
dopamine.data = dopamine.data |>
mutate(difference = Closer_vals - Farther_vals)
view(dopamine.data)
#Task 3: Summarize the data
library(patchwork)
summary = function(data) {
mean = mean(data)
min = min(data)
max = max(data)
sd = sd(data)
median = median(data)
return(c(min, max, median, mean, sd))
}
farther = summary(dopamine.data$`Farther_vals`)
closer = summary(dopamine.data$`Closer_vals`)
differences = summary(dopamine.data$difference)
table = data.frame()
table = rbind(farther,
closer,
differences) |> as.data.frame()
summary.table = table |>
rename(min = "V1",
max = "V2",
median = "V3",
mean = "V4",
sd = "V5")
view(summary.table)
farther.plot = ggplot(data = dopamine.data, aes(x=`Farther_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(-0.7,0,0.07)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when further away") +
theme(plot.title = element_text(size = 8))
closer.plot = ggplot(data = dopamine.data, aes(x=`Closer_vals`))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,0.35,0.035)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Change in dopamine")+
ylab("Density")+
labs(color = "", title = "Change in dopamine levels when closer") +
theme(plot.title = element_text(size = 8))
differences.plot = ggplot(data = dopamine.data, aes(x=difference))+
geom_histogram(aes(y=after_stat(density)),
breaks=seq(0,1,0.08)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Difference between changes in dopamine")+
ylab("Density")+
labs(color = "", title = "Difference in dopamine levels for young zebra finches further away vs closer") +
theme(plot.title = element_text(size = 9))
(farther.plot + closer.plot) / differences.plot
#Task 4: Conduct the tests
#part a
install.packages("effectsize")
library(effectsize)
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
closer.t.test
g = hedges_g(x = dopamine.data$`Closer_vals`, mu = 0, alternative = "two.sided")
#part b
farther.t.test = t.test(x=dopamine.data$`Farther_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
farther.t.test
g = hedges_g(x = dopamine.data$`Farther_vals`, mu = 0, alternative = "two.sided")
#part c
differences.t.test = t.test(x=dopamine.data$`difference`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
differences.t.test
g = hedges_g(x = dopamine.data$`difference`, mu = 0, alternative = "two.sided")
null.dat = tibble(t=seq(-5, 5, length.out = 1000)) |>
mutate(density.null = dt(t, df=n-1))
closer.t.test = t.test(x=dopamine.data$`Closer_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
closer.t.test
#Part a
null.dat = tibble(t=seq(-5, 5, length.out = 1000)) |>
mutate(density.null = dt(t, df=24))
null.plot = ggplot() +
# null distribution
geom_line(data=null.dat,
aes(x=t, y=density.null))+
geom_hline(yintercept=0)+
# rejection regions
geom_ribbon(data=subset(null.dat, t<=qt(0.025, df=24)),
aes(x=t, ymin=0, ymax=density.null),
fill="grey", alpha=0.5)+
geom_ribbon(data=subset(null.dat, t>=qt(0.975, df=24)),
aes(x=t, ymin=0, ymax=density.null),
fill="grey", alpha=0.5)
null.plot
null.dat = tibble(t=seq(-5, 5, length.out = 1000)) |>
mutate(density.null = dt(t, df=24))
null.plot = ggplot() +
# null distribution
geom_line(data=null.dat,
aes(x=t, y=density.null))+
geom_hline(yintercept=0)+
# rejection regions
geom_ribbon(data=subset(null.dat, t<=qt(0.025, df=24)),
aes(x=t, ymin=0, ymax=density.null),
fill="red", alpha=0.5)+
geom_ribbon(data=subset(null.dat, t>=qt(0.975, df=24)),
aes(x=t, ymin=0, ymax=density.null),
fill="red", alpha=0.5)
null.plot
farther.t.test = t.test(x=dopamine.data$`Farther_vals`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
farther.t.test
differences.t.test = t.test(x=dopamine.data$`difference`,
alternative = "two.sided", mu = 0, conf.level = 0.95)
differences.t.test
